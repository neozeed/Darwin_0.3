/* Definitions to target GDB to Linux on 386.
   Copyright 1992, 1993 Free Software Foundation, Inc.

This file is part of GDB.

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */

#ifndef TM_LINUX_H
#define TM_LINUX_H

#include "powerpc/tm-ppc-eabi.h"

/* We can single step on linux */
#undef NO_SINGLE_STEP

/* We _want_ the SVR4 section offset calculations (see syms_from_objfile()
   in symfile.c) */
#undef IBM6000_TARGET

/* Offset to saved PC in sigcontext, from <linux/signal.h>.  */
#define SIGCONTEXT_PC_OFFSET 184

/* Avoid warning from redefinition in tm-sysv4.h */
#undef SKIP_TRAMPOLINE_CODE

/* We need this file for the SOLIB_TRAMPOLINE stuff. */
#include "tm-sysv4.h"

#undef SKIP_TRAMPOLINE_CODE
extern CORE_ADDR skip_trampoline_code (CORE_ADDR pc);
#define	SKIP_TRAMPOLINE_CODE(pc) skip_trampoline_code (pc)

#define CANNOT_FETCH_REGISTER(regno) ((regno) == MQ_REGNUM)
#define CANNOT_STORE_REGISTER(regno) ((regno) == MQ_REGNUM)

/* Linux doesn't use the PowerOpen ABI for function pointer representation */
#undef CONVERT_FROM_FUNC_PTR_ADDR

#undef INIT_EXTRA_FRAME_INFO(fromleaf, fi)
#define	INIT_EXTRA_FRAME_INFO(fromleaf, fi)	\
	init_extra_frame_info (fromleaf, fi)
extern void init_extra_frame_info ();

#undef FRAME_FIND_SAVED_REGS
struct frame_saved_regs;
struct frame_info;
void frame_find_saved_regs PARAMS((struct frame_info *fi,
				   struct frame_saved_regs *fsr));
#define FRAME_FIND_SAVED_REGS(frame_info, frame_saved_regs) \
        frame_find_saved_regs (frame_info, &frame_saved_regs)

#undef INIT_FRAME_PC_FIRST
#define INIT_FRAME_PC_FIRST(fromleaf, prev) \
  	init_frame_pc_first(fromleaf, prev)

/* There is come problem with the debugging symbols generated by the
   compiler such that the debugging symbol for the first line of a
   function overlap with the function prologue.  */
#define PROLOGUE_FIRSTLINE_OVERLAP

#endif  /* #ifndef TM_LINUX_H */
